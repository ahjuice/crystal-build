#!/usr/bin/env perl

use strict;
use warnings;
use utf8;

use FindBin;
use lib "$FindBin::Bin/../lib";

use Cwd qw/abs_path/;

use Crenv;
use Crenv::Utils;
use Crenv::Fetcher;

sub main {
    my $args        = Crenv::Utils::parse_args(@ARGV);
    my $github_repo = 'manastech/crystal';

    my $crenv = Crenv->new(
        prefix      => $args->{prefix},
        fetcher     => Crenv::Fetcher->get(fetcher_type()),
        github_repo => $github_repo,
    );

    if ($args->{definitions}) {
        $crenv->show_definitions;
    }

    else {
        $crenv->install($args->{version});
    }
}

sub fetcher_type {
    `which curl` ? 'curl' :
    `which wget` ? 'wget' :
        die 'Need curl or wget';
}

main unless caller;

# vim: se et ts=4 sw=4 sts=4 ft=perl :
